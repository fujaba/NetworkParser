// -PlectureBuild -Pjenkins clean --refresh-dependencies build
apply plugin: 'java'
apply plugin: 'maven'
apply from: 'gradle/version.gradle'
apply from: 'gradle/tasks.gradle'
apply plugin: 'jacoco'

repositories {
	jcenter()
	mavenCentral()
}
test {
	// enable TestNG support (default is JUnit)
	useJUnit {
		dependencies {
		compile(group: 'junit', name: 'junit', version: '4.+')
		}
	}
}
buildscript {
	repositories {
		jcenter()
	}
	dependencies {
		classpath(group: 'org.jfrog.buildinfo', name: 'build-info-extractor-gradle', version: '2.2.4')
	}
}

// only for jenkins
if(project.hasProperty('jenkins')) {
	//Artifactory
	apply from: 'gradle/artifactory.gradle'
	if(new File("secring.gpg").exists()) {
		apply plugin: 'signing'
		apply from: 'gradle/mavencentral.gradle'
	}
} else {
	apply from: 'gradle/ide.gradle'
}

jacoco {
    toolVersion = "0.7.4.201502262128"
}
jacocoTestReport {
    group = "Reporting"
    description = "Generate Jacoco coverage reports after running tests."
    executionData = files("$buildDir/jacoco/test.exec")
    reports {
        xml {
            enabled true
            //Following value is a file
            destination "${buildDir}/reports/jacoco/jacoco.xml"
        }
        csv.enabled false
        html {
            enabled true
            //Following value is a folder
            destination "${buildDir}/reports/jacoco"
        }
    }
}

sourceSets.main.output.classesDir 'build/classes/main'

sourceCompatibility = 1.8
targetCompatibility = 1.8

defaultTasks 'clean', 'test', 'all'
