// -PlectureBuild -Pjenkins clean --refresh-dependencies build artifactoryPublish
// gradlew clean test build jar build javadocJar build fatJar
// gradlew clean test build jar build javadocJar build fatJar -PNetworkParserFX 
// gradlew javadoc all
apply plugin: 'java'
apply plugin: 'maven'
apply from: 'gradle/version.gradle'
apply from: 'gradle/tasks.gradle'

// only for jenkins
if(project.hasProperty('jenkins')) {
	apply from: 'gradle/artifactory.gradle'
    apply plugin: 'jacoco'
	
	//tbd - need configuration
	//apply plugin: 'checkstyle'
	//apply plugin: 'findbugs'
} else {
	apply from: 'gradle/ide.gradle'
}
if(project.hasProperty('JarName')){
	apply from: 'gradle/'+project.getProperty('JarName')+'.gradle'
	project.archivesBaseName = project.getProperty('JarName')
} else {
	apply from: 'gradle/NetworkParser.gradle'
}

buildscript {
    repositories {
        jcenter()
    }
    dependencies {
        classpath(group: 'org.jfrog.buildinfo', name: 'build-info-extractor-gradle', version: '2.2.4')
    }
}

jacoco {
    toolVersion = "0.7.0.201403182114"
}
task codeCoverageReport(type: JacocoReport) {

    // Gather execution data from all subprojects
    // (change this if you e.g. want to calculate uni test/integration test coverage separately)
    // executionData
fileTree(project.rootDir.absolutePath).include("**/build/jacoco/*.exec")

    // Add all relevant sourcesets from the subprojects
    subprojects.each {
       sourceSets it.sourceSets.main
    }

    reports {
      xml.enabled true
      html.enabled true
      html.destination "${buildDir}/reports/jacoco"
      csv.enabled false
    }
}

// always run the tests before generating the report
codeCoverageReport.dependsOn {
    subprojects*.test
}

sourceCompatibility = 1.8
targetCompatibility = 1.8


repositories {
	mavenCentral()
	if(project.hasProperty('JarName')){
		// NetworkParser
		if(project.hasProperty('lectureBuild')) {
			maven { url "https://se.cs.uni-kassel.de/artifactory/lecture" }
		}else{
			maven { url "https://se.cs.uni-kassel.de/artifactory/libs-snapshot-local" }
		}
	}
}

dependencies {
	testCompile group: 'junit', name: 'junit', version: '4.+'
	if(project.hasProperty('JarName')){
		compile 'de.uniks:NetworkParser:4.2+:full'
	}
}

